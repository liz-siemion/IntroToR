<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Tidyverse | CDFW Introduction to R Programming</title>
  <meta name="description" content="Chapter 6 Tidyverse | CDFW Introduction to R Programming Workshop" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Tidyverse | CDFW Introduction to R Programming" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapter 6 Tidyverse | CDFW Introduction to R Programming Workshop" />
  <meta name="github-repo" content="liz-siemion/IntroToR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Tidyverse | CDFW Introduction to R Programming" />
  
  <meta name="twitter:description" content="Chapter 6 Tidyverse | CDFW Introduction to R Programming Workshop" />
  

<meta name="author" content="Liz Siemion &amp; Dave German" />


<meta name="date" content="2025-05-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="using-r.html"/>
<link rel="next" href="import-export.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CDFW Introduction to R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#workshop-goals"><i class="fa fa-check"></i><b>1.1</b> Workshop Goals</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#workshop-content"><i class="fa fa-check"></i><b>1.2</b> Workshop Content</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Intro to R and R-Studio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#directory-structure"><i class="fa fa-check"></i><b>2.2</b> Directory Structure</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#r-studio"><i class="fa fa-check"></i><b>2.3</b> R Studio</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#rstudio-projects"><i class="fa fa-check"></i><b>2.4</b> RStudio Projects</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="file.html"><a href="file.html"><i class="fa fa-check"></i><b>3</b> File paths</a>
<ul>
<li class="chapter" data-level="3.1" data-path="file.html"><a href="file.html#what-is-a-file-path"><i class="fa fa-check"></i><b>3.1</b> What is a file path?</a></li>
<li class="chapter" data-level="3.2" data-path="file.html"><a href="file.html#different-separators-between-operating-systems"><i class="fa fa-check"></i><b>3.2</b> Different separators between operating systems</a></li>
<li class="chapter" data-level="3.3" data-path="file.html"><a href="file.html#absolute-and-relative-file-paths"><i class="fa fa-check"></i><b>3.3</b> Absolute and Relative file paths</a></li>
<li class="chapter" data-level="3.4" data-path="file.html"><a href="file.html#navigating-outside-the-working-directory"><i class="fa fa-check"></i><b>3.4</b> Navigating outside the working directory</a></li>
<li class="chapter" data-level="3.5" data-path="file.html"><a href="file.html#using-the-tab-shortcut-in-rstudio"><i class="fa fa-check"></i><b>3.5</b> Using the Tab Shortcut in RStudio</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>4</b> Tidy Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tidy-data.html"><a href="tidy-data.html#tidy-data-1"><i class="fa fa-check"></i><b>4.1</b> Tidy Data</a></li>
<li class="chapter" data-level="4.2" data-path="tidy-data.html"><a href="tidy-data.html#document-your-code"><i class="fa fa-check"></i><b>4.2</b> Document your code</a></li>
<li class="chapter" data-level="4.3" data-path="tidy-data.html"><a href="tidy-data.html#rows-for-observations-columns-for-variables"><i class="fa fa-check"></i><b>4.3</b> Rows for Observations, Columns for Variables</a></li>
<li class="chapter" data-level="4.4" data-path="tidy-data.html"><a href="tidy-data.html#problemmatic-practices"><i class="fa fa-check"></i><b>4.4</b> Problemmatic Practices</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="using-r.html"><a href="using-r.html"><i class="fa fa-check"></i><b>5</b> Using R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="using-r.html"><a href="using-r.html#packages"><i class="fa fa-check"></i><b>5.1</b> Installing Packages</a></li>
<li class="chapter" data-level="5.2" data-path="using-r.html"><a href="using-r.html#using-comments"><i class="fa fa-check"></i><b>5.2</b> Using Comments</a></li>
<li class="chapter" data-level="5.3" data-path="using-r.html"><a href="using-r.html#functions"><i class="fa fa-check"></i><b>5.3</b> Functions</a></li>
<li class="chapter" data-level="5.4" data-path="using-r.html"><a href="using-r.html#use-r-as-a-calculator"><i class="fa fa-check"></i><b>5.4</b> Use R as a calculator</a></li>
<li class="chapter" data-level="5.5" data-path="using-r.html"><a href="using-r.html#use-r-to-compare-things"><i class="fa fa-check"></i><b>5.5</b> Use R to compare things</a></li>
<li class="chapter" data-level="5.6" data-path="using-r.html"><a href="using-r.html#r-objects"><i class="fa fa-check"></i><b>5.6</b> Use R to assign objects</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="using-r.html"><a href="using-r.html#variable-names"><i class="fa fa-check"></i><b>5.6.1</b> Variable names</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="using-r.html"><a href="using-r.html#data-types"><i class="fa fa-check"></i><b>5.7</b> Data Types (Modes)</a></li>
<li class="chapter" data-level="5.8" data-path="using-r.html"><a href="using-r.html#other-object-types"><i class="fa fa-check"></i><b>5.8</b> Other Object Types</a></li>
<li class="chapter" data-level="5.9" data-path="using-r.html"><a href="using-r.html#data-classes"><i class="fa fa-check"></i><b>5.9</b> Data Structure Classes</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="using-r.html"><a href="using-r.html#scalar"><i class="fa fa-check"></i><b>5.9.1</b> Scalar</a></li>
<li class="chapter" data-level="5.9.2" data-path="using-r.html"><a href="using-r.html#vector"><i class="fa fa-check"></i><b>5.9.2</b> Vector</a></li>
<li class="chapter" data-level="5.9.3" data-path="using-r.html"><a href="using-r.html#lists"><i class="fa fa-check"></i><b>5.9.3</b> Lists</a></li>
<li class="chapter" data-level="5.9.4" data-path="using-r.html"><a href="using-r.html#matrix"><i class="fa fa-check"></i><b>5.9.4</b> Matrix</a></li>
<li class="chapter" data-level="5.9.5" data-path="using-r.html"><a href="using-r.html#data-frames"><i class="fa fa-check"></i><b>5.9.5</b> Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="using-r.html"><a href="using-r.html#index"><i class="fa fa-check"></i><b>5.10</b> Indexing</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="using-r.html"><a href="using-r.html#numerical-indexing"><i class="fa fa-check"></i><b>5.10.1</b> Numerical Indexing</a></li>
<li class="chapter" data-level="5.10.2" data-path="using-r.html"><a href="using-r.html#named-indexing"><i class="fa fa-check"></i><b>5.10.2</b> Named Indexing</a></li>
<li class="chapter" data-level="5.10.3" data-path="using-r.html"><a href="using-r.html#logical-indexing"><i class="fa fa-check"></i><b>5.10.3</b> Logical Indexing</a></li>
<li class="chapter" data-level="5.10.4" data-path="using-r.html"><a href="using-r.html#range-or-sequence-indexing"><i class="fa fa-check"></i><b>5.10.4</b> Range or Sequence Indexing</a></li>
<li class="chapter" data-level="5.10.5" data-path="using-r.html"><a href="using-r.html#negative-indexing"><i class="fa fa-check"></i><b>5.10.5</b> Negative Indexing</a></li>
<li class="chapter" data-level="5.10.6" data-path="using-r.html"><a href="using-r.html#which-indexing"><i class="fa fa-check"></i><b>5.10.6</b> Which Indexing</a></li>
<li class="chapter" data-level="5.10.7" data-path="using-r.html"><a href="using-r.html#indexing-different-data-types"><i class="fa fa-check"></i><b>5.10.7</b> Indexing different data types</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="using-r.html"><a href="using-r.html#baser-plotting"><i class="fa fa-check"></i><b>5.11</b> BaseR Plotting</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>6</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="6.1" data-path="tidyverse.html"><a href="tidyverse.html#why-tidyverse"><i class="fa fa-check"></i><b>6.1</b> Why Tidyverse?</a></li>
<li class="chapter" data-level="6.2" data-path="tidyverse.html"><a href="tidyverse.html#tibbles"><i class="fa fa-check"></i><b>6.2</b> Tibbles</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="tidyverse.html"><a href="tidyverse.html#improved-printing"><i class="fa fa-check"></i><b>6.2.1</b> Improved printing</a></li>
<li class="chapter" data-level="6.2.2" data-path="tidyverse.html"><a href="tidyverse.html#subsetting"><i class="fa fa-check"></i><b>6.2.2</b> Subsetting</a></li>
<li class="chapter" data-level="6.2.3" data-path="tidyverse.html"><a href="tidyverse.html#recycling"><i class="fa fa-check"></i><b>6.2.3</b> Recycling</a></li>
<li class="chapter" data-level="6.2.4" data-path="tidyverse.html"><a href="tidyverse.html#tibble-vs.-data-frame-key-differences"><i class="fa fa-check"></i><b>6.2.4</b> Tibble vs. Data Frame — Key Differences</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="tidyverse.html"><a href="tidyverse.html#tidyverse-functions"><i class="fa fa-check"></i><b>6.3</b> Tidyverse Functions</a></li>
<li class="chapter" data-level="6.4" data-path="tidyverse.html"><a href="tidyverse.html#tidyverse-vs-baser"><i class="fa fa-check"></i><b>6.4</b> Tidyverse vs BaseR</a></li>
<li class="chapter" data-level="6.5" data-path="tidyverse.html"><a href="tidyverse.html#ggplot"><i class="fa fa-check"></i><b>6.5</b> ggplot</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="tidyverse.html"><a href="tidyverse.html#components-of-ggplot"><i class="fa fa-check"></i><b>6.5.1</b> Components of ggplot</a></li>
<li class="chapter" data-level="6.5.2" data-path="tidyverse.html"><a href="tidyverse.html#different-plots-in-ggplot"><i class="fa fa-check"></i><b>6.5.2</b> Different plots in ggplot</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="tidyverse.html"><a href="tidyverse.html#tidyverse-analysis-example"><i class="fa fa-check"></i><b>6.6</b> Tidyverse Analysis Example</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="tidyverse.html"><a href="tidyverse.html#load-libraries"><i class="fa fa-check"></i><b>6.6.1</b> Load libraries</a></li>
<li class="chapter" data-level="6.6.2" data-path="tidyverse.html"><a href="tidyverse.html#examine-data-frame"><i class="fa fa-check"></i><b>6.6.2</b> Examine data frame</a></li>
<li class="chapter" data-level="6.6.3" data-path="tidyverse.html"><a href="tidyverse.html#manipulate-data-frame"><i class="fa fa-check"></i><b>6.6.3</b> Manipulate data frame</a></li>
<li class="chapter" data-level="6.6.4" data-path="tidyverse.html"><a href="tidyverse.html#analysis"><i class="fa fa-check"></i><b>6.6.4</b> Analysis</a></li>
<li class="chapter" data-level="6.6.5" data-path="tidyverse.html"><a href="tidyverse.html#plot-results-using-ggplot2"><i class="fa fa-check"></i><b>6.6.5</b> Plot results using ggplot2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="import-export.html"><a href="import-export.html"><i class="fa fa-check"></i><b>7</b> Importing &amp; Exporting Data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="import-export.html"><a href="import-export.html#csv-files"><i class="fa fa-check"></i><b>7.1</b> csv files</a></li>
<li class="chapter" data-level="7.2" data-path="import-export.html"><a href="import-export.html#xlsx-files"><i class="fa fa-check"></i><b>7.2</b> xlsx files</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="import-export.html"><a href="import-export.html#rds-files"><i class="fa fa-check"></i><b>7.2.1</b> rds files</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="import-export.html"><a href="import-export.html#connect-to-a-database-on-windows-os"><i class="fa fa-check"></i><b>7.3</b> Connect to a database on Windows OS</a></li>
<li class="chapter" data-level="7.4" data-path="import-export.html"><a href="import-export.html#load-database-files-on-a-macbook"><i class="fa fa-check"></i><b>7.4</b> Load database files on a Macbook</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-org.html"><a href="data-org.html"><i class="fa fa-check"></i><b>8</b> Data Organization</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-org.html"><a href="data-org.html#exploring-data-frames"><i class="fa fa-check"></i><b>8.1</b> Exploring Data Frames</a></li>
<li class="chapter" data-level="8.2" data-path="data-org.html"><a href="data-org.html#vectorized"><i class="fa fa-check"></i><b>8.2</b> Vectorized Operations</a></li>
<li class="chapter" data-level="8.3" data-path="data-org.html"><a href="data-org.html#data-frame-manipulation"><i class="fa fa-check"></i><b>8.3</b> Data Frame Manipulation</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="control.html"><a href="control.html"><i class="fa fa-check"></i><b>9</b> Control Structures</a>
<ul>
<li class="chapter" data-level="9.1" data-path="control.html"><a href="control.html#for-loops"><i class="fa fa-check"></i><b>9.1</b> Loops</a></li>
<li class="chapter" data-level="9.2" data-path="control.html"><a href="control.html#troubleshooting-for-loops"><i class="fa fa-check"></i><b>9.2</b> Troubleshooting For-loops</a></li>
<li class="chapter" data-level="9.3" data-path="control.html"><a href="control.html#if-else-and-ifelse-statements"><i class="fa fa-check"></i><b>9.3</b> if, else, and ifelse statements</a></li>
<li class="chapter" data-level="9.4" data-path="control.html"><a href="control.html#next-and-break"><i class="fa fa-check"></i><b>9.4</b> next and break</a></li>
<li class="chapter" data-level="9.5" data-path="control.html"><a href="control.html#keeping-track-of-loop"><i class="fa fa-check"></i><b>9.5</b> Keeping track of loop</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="statistical-summaries.html"><a href="statistical-summaries.html"><i class="fa fa-check"></i><b>10</b> Statistical Summaries</a></li>
<li class="chapter" data-level="11" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>11</b> Debugging Code</a>
<ul>
<li class="chapter" data-level="11.1" data-path="debugging.html"><a href="debugging.html#locating-problematic-code"><i class="fa fa-check"></i><b>11.1</b> Locating Problematic Code</a></li>
<li class="chapter" data-level="11.2" data-path="debugging.html"><a href="debugging.html#syntax-errors"><i class="fa fa-check"></i><b>11.2</b> Syntax errors</a></li>
<li class="chapter" data-level="11.3" data-path="debugging.html"><a href="debugging.html#missing-and-undefined-data"><i class="fa fa-check"></i><b>11.3</b> Missing and Undefined Data</a></li>
<li class="chapter" data-level="11.4" data-path="debugging.html"><a href="debugging.html#coercian-problems"><i class="fa fa-check"></i><b>11.4</b> Coercian Problems</a></li>
<li class="chapter" data-level="11.5" data-path="debugging.html"><a href="debugging.html#labeling-function-arguments"><i class="fa fa-check"></i><b>11.5</b> Labeling function arguments</a></li>
<li class="chapter" data-level="11.6" data-path="debugging.html"><a href="debugging.html#conflicting-functions"><i class="fa fa-check"></i><b>11.6</b> Conflicting Functions</a></li>
<li class="chapter" data-level="11.7" data-path="debugging.html"><a href="debugging.html#use-the-help-function"><i class="fa fa-check"></i><b>11.7</b> Use the Help <code>?</code> Function!</a></li>
<li class="chapter" data-level="11.8" data-path="debugging.html"><a href="debugging.html#google"><i class="fa fa-check"></i><b>11.8</b> Google</a></li>
<li class="chapter" data-level="11.9" data-path="debugging.html"><a href="debugging.html#ai"><i class="fa fa-check"></i><b>11.9</b> AI</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="readable-r.html"><a href="readable-r.html"><i class="fa fa-check"></i><b>12</b> Making Readable R Code</a>
<ul>
<li class="chapter" data-level="12.1" data-path="readable-r.html"><a href="readable-r.html#outlining-r-scripts"><i class="fa fa-check"></i><b>12.1</b> Outlining R Scripts</a></li>
<li class="chapter" data-level="12.2" data-path="readable-r.html"><a href="readable-r.html#pseudocoding"><i class="fa fa-check"></i><b>12.2</b> Pseudocoding</a></li>
<li class="chapter" data-level="12.3" data-path="readable-r.html"><a href="readable-r.html#making-readable-r-code"><i class="fa fa-check"></i><b>12.3</b> Making Readable R Code</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="class-wrap-up.html"><a href="class-wrap-up.html"><i class="fa fa-check"></i><b>13</b> Class Wrap Up</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CDFW Introduction to R Programming</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidyverse" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Tidyverse<a href="tidyverse.html#tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="why-tidyverse" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Why Tidyverse?<a href="tidyverse.html#why-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>tidyverse</code> is a collection of R packages designed to simplify and streamline data science tasks. It promotes the concept of “tidy data,” where each column is a variable and each row is an observation, which simplifies analysis and visualization. Core tidyverse packages include <code>ggplot2</code> for plotting, <code>dplyr</code> for data manipulation, and <code>tidyr</code> for reshaping data.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="tidyverse.html#cb107-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching core tidyverse packages ── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.4     ✔ readr     2.1.5
## ✔ forcats   1.0.0     ✔ stringr   1.5.1
## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
## ✔ purrr     1.0.2     
## ── Conflicts ──────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<p>Notice the Conflicts from loading the tidyverse package.</p>
<p>One of the key strengths of the tidyverse is its readable syntax, especially with the use of the pipe operator <code>(%&gt;%)</code>, which allows users to chain together multiple steps in a clear, logical order.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="tidyverse.html#cb109-1" tabindex="-1"></a><span class="co"># example of using a piped operation</span></span>
<span id="cb109-2"><a href="tidyverse.html#cb109-2" tabindex="-1"></a>sheep <span class="ot">&lt;-</span> <span class="fu">filter</span>(<span class="at">x =</span> sheep, herds <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Bx&quot;</span>, <span class="st">&quot;Cn&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="tidyverse.html#cb109-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Yr_Month =</span> <span class="fu">paste</span>(Year, Month, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>))</span></code></pre></div>
<p>Note that I had to specify the object <code>sheep</code> in the <code>filter()</code> function, but not in the <code>mutate()</code> function. The <code>%&gt;%</code> operator tells R to pass the sheep data frame through the pipeline, so it’s automatically used in the subsequent function.</p>
<p>Learning tidyverse provides efficient tools and workflows for data cleaning, exploration, and analysis. One of the most commonly used packages within the <code>tidyverse</code> is <code>dplyr</code> (data plier), which provides a set of powerful and intuitive functions for manipulating data frames. With dplyr, you can easily filter rows, select columns, create new variables, group data, and summarize it—all using clear, readable code.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Consistent syntax across packages, making code easier to write and read.</li>
<li>Tidy data structure, where each variable is a column and each observation is a row.</li>
<li>Readable workflows using the pipe operator (%&gt;%) to chain commands clearly.</li>
<li>Integrated tools for the entire data science process—importing, cleaning, transforming, visualizing, and modeling data.</li>
<li>User-friendly functions with intuitive names and logical default argument values.</li>
<li>Open-source and widely supported, with ample online learning resources</li>
<li>Provides tools for data manipulation, exploration, and visualization.</li>
<li>Uses piping (%&gt;%) to create readable, fluent workflows (through the magrittr package)</li>
<li>The Tidyverse’s <code>Tibble</code> data structure offers a modern, consistent alternative to data frames, with improved subsetting behavior, better printing, and stricter data handling</li>
</ul>
</div>
<div id="tibbles" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Tibbles<a href="tidyverse.html#tibbles" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The tidyverse uses a modern type of data frame structure called a <code>Tibble</code> that has a <code>tbl</code> class, a <code>tbl_df</code> class and a <code>data.frame</code> class.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="tidyverse.html#cb110-1" tabindex="-1"></a><span class="co"># Create a tibble manually</span></span>
<span id="cb110-2"><a href="tidyverse.html#cb110-2" tabindex="-1"></a>my_tibble <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb110-3"><a href="tidyverse.html#cb110-3" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;S432&quot;</span>, <span class="st">&quot;S678&quot;</span>, <span class="st">&quot;S573&quot;</span>),</span>
<span id="cb110-4"><a href="tidyverse.html#cb110-4" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">6</span>)</span>
<span id="cb110-5"><a href="tidyverse.html#cb110-5" tabindex="-1"></a>)</span>
<span id="cb110-6"><a href="tidyverse.html#cb110-6" tabindex="-1"></a></span>
<span id="cb110-7"><a href="tidyverse.html#cb110-7" tabindex="-1"></a><span class="fu">class</span>(my_tibble)</span></code></pre></div>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<div id="improved-printing" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Improved printing<a href="tidyverse.html#improved-printing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Unlike data frames, tibbles only print the first 10 rows by default and only show the columns that fit on your screen, producing more readable output. The data types of each column are displayed underneath the column names, making it easier to understand your data quickly. It also prints an abbreviated description of the column type, and uses font styles and colors for highlighting.</p>
<p>In addition, numbers are displayed with three significant figures by default, and a trailing dot indicates the existence of a fractional component. You can control the default appearance with options.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="tidyverse.html#cb112-1" tabindex="-1"></a>my_tibble</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   name    age
##   &lt;chr&gt; &lt;dbl&gt;
## 1 S432      4
## 2 S678      2
## 3 S573      6</code></pre>
</div>
<div id="subsetting" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Subsetting<a href="tidyverse.html#subsetting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Tibbles are stricter and more consistent than base data frames when it comes to subsetting:</p>
<p>When subsetting with tibbles using <code>[</code>, the result is always another tibble, even if you’re selecting a single column. This makes the behavior more predictable, especially in pipelines.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="tidyverse.html#cb114-1" tabindex="-1"></a>my_tibble[<span class="dv">1</span>]      <span class="co"># Returns a tibble with one column</span></span></code></pre></div>
<pre><code>## # A tibble: 3 × 1
##   name 
##   &lt;chr&gt;
## 1 S432 
## 2 S678 
## 3 S573</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="tidyverse.html#cb116-1" tabindex="-1"></a>my_tibble[[<span class="dv">1</span>]]    <span class="co"># Returns a vector (just the values from column x)</span></span></code></pre></div>
<pre><code>## [1] &quot;S432&quot; &quot;S678&quot; &quot;S573&quot;</code></pre>
<p>In contrast, subsetting with data frames using <code>[</code> may return a data frame or a vector, depending on the context:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="tidyverse.html#cb118-1" tabindex="-1"></a>my_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb118-2"><a href="tidyverse.html#cb118-2" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;S432&quot;</span>, <span class="st">&quot;S678&quot;</span>, <span class="st">&quot;S573&quot;</span>),</span>
<span id="cb118-3"><a href="tidyverse.html#cb118-3" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">6</span>))</span>
<span id="cb118-4"><a href="tidyverse.html#cb118-4" tabindex="-1"></a>my_df[<span class="dv">1</span>]      <span class="co"># Returns a data frame</span></span></code></pre></div>
<pre><code>##   name
## 1 S432
## 2 S678
## 3 S573</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="tidyverse.html#cb120-1" tabindex="-1"></a>my_df[, <span class="dv">1</span>]    <span class="co"># Returns a vector</span></span></code></pre></div>
<pre><code>## [1] &quot;S432&quot; &quot;S678&quot; &quot;S573&quot;</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="tidyverse.html#cb122-1" tabindex="-1"></a>my_df[<span class="dv">1</span>, ]    <span class="co"># Returns a data frame (one row)</span></span></code></pre></div>
<pre><code>##   name age
## 1 S432   4</code></pre>
<p>Tibbles are also more strict with the <code>$</code> operator: Tibbles do not allow partial matching. If the column name you use doesn’t match exactly, it will return <code>NULL</code> and may show a warning. As a result, tibbles can be safer than data frames, especially with data sets with similar column names.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="tidyverse.html#cb124-1" tabindex="-1"></a>my_tibble<span class="sc">$</span>na</span></code></pre></div>
<pre><code>## Warning: Unknown or uninitialised column: `na`.</code></pre>
<pre><code>## NULL</code></pre>
<p>Data frames allow partial matching, which can lead to unexpected results:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="tidyverse.html#cb127-1" tabindex="-1"></a>my_df<span class="sc">$</span>name</span></code></pre></div>
<pre><code>## [1] &quot;S432&quot; &quot;S678&quot; &quot;S573&quot;</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="tidyverse.html#cb129-1" tabindex="-1"></a>my_df<span class="sc">$</span>na</span></code></pre></div>
<pre><code>## [1] &quot;S432&quot; &quot;S678&quot; &quot;S573&quot;</code></pre>
</div>
<div id="recycling" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Recycling<a href="tidyverse.html#recycling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When constructing a tibble, only values of length 1 are recycled. The first column with length different to one determines the number of rows in the tibble, conflicts lead to an error.</p>
<p>In R, recycling happens when you combine vectors of different lengths—shorter vectors are automatically repeated to match the longer ones. While this can be convenient, it can also lead to unintended results if you’re not careful.</p>
<p>In a data frame recycling often happens silently, even if the lengths don’t align exactly:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="tidyverse.html#cb131-1" tabindex="-1"></a>my_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb131-2"><a href="tidyverse.html#cb131-2" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;S432&quot;</span>, <span class="st">&quot;S678&quot;</span>, <span class="st">&quot;S573&quot;</span>, <span class="st">&quot;S698&quot;</span>),</span>
<span id="cb131-3"><a href="tidyverse.html#cb131-3" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>))</span>
<span id="cb131-4"><a href="tidyverse.html#cb131-4" tabindex="-1"></a>my_df</span></code></pre></div>
<pre><code>##   name age
## 1 S432   4
## 2 S678   2
## 3 S573   4
## 4 S698   2</code></pre>
<p>Here, the shorter <code>age</code> vector <code>age = c(4, 2)</code> is silently recycled to fill the 4 rows of the data frame.</p>
<p>Tibbles are stricter about recycling:</p>
<ul>
<li>Tibbles only allow recycling if the shorter vector is length 1.</li>
<li>If the lengths don’t match and can’t be safely recycled, tibbles will return an error—helping you catch mistakes early.</li>
</ul>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="tidyverse.html#cb133-1" tabindex="-1"></a><span class="co"># This works — length 1 value recycled</span></span>
<span id="cb133-2"><a href="tidyverse.html#cb133-2" tabindex="-1"></a>my_tibble <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb133-3"><a href="tidyverse.html#cb133-3" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;S432&quot;</span>, <span class="st">&quot;S678&quot;</span>, <span class="st">&quot;S573&quot;</span>, <span class="st">&quot;S698&quot;</span>),</span>
<span id="cb133-4"><a href="tidyverse.html#cb133-4" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">2</span>))</span>
<span id="cb133-5"><a href="tidyverse.html#cb133-5" tabindex="-1"></a></span>
<span id="cb133-6"><a href="tidyverse.html#cb133-6" tabindex="-1"></a><span class="co"># This fails — length 2 can&#39;t be recycled to length 4</span></span>
<span id="cb133-7"><a href="tidyverse.html#cb133-7" tabindex="-1"></a>my_tibble <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb133-8"><a href="tidyverse.html#cb133-8" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;S432&quot;</span>, <span class="st">&quot;S678&quot;</span>, <span class="st">&quot;S573&quot;</span>, <span class="st">&quot;S698&quot;</span>),</span>
<span id="cb133-9"><a href="tidyverse.html#cb133-9" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## Error in `tibble()`:
## ! Tibble columns must have compatible sizes.
## • Size 4: Existing data.
## • Size 2: Column `age`.
## ℹ Only values of size one are recycled.</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="tidyverse.html#cb135-1" tabindex="-1"></a><span class="co"># Error: Tibble columns must have consistent lengths</span></span></code></pre></div>
</div>
<div id="tibble-vs.-data-frame-key-differences" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Tibble vs. Data Frame — Key Differences<a href="tidyverse.html#tibble-vs.-data-frame-key-differences" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Below is a table summarizing the differences between data frames and tibbles. You can also see <code>vignette("invariants")</code> for a detailed comparison between tibbles and data frames.</p>
<table>
<colgroup>
<col width="21%" />
<col width="35%" />
<col width="42%" />
</colgroup>
<thead>
<tr>
<th align="left">Feature</th>
<th>Base R Data Frame</th>
<th>Tibble (from <code>tibble</code> package)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><strong>Printing</strong></td>
<td>Prints entire dataset, which can flood console</td>
<td>Prints first 10 rows and fits columns to screen width</td>
</tr>
<tr>
<td align="left"><strong>Column types shown?</strong></td>
<td>No</td>
<td>Yes — shows column types under names</td>
</tr>
<tr>
<td align="left"><strong>Type conversion on import</strong></td>
<td>Often converts strings to factors (<code>read.csv</code>)</td>
<td>Does not convert strings to factors by default</td>
</tr>
<tr>
<td align="left"><strong>Partial column name match</strong></td>
<td>Allows it (<code>df$na</code> may match <code>name</code>)</td>
<td>Disallows it — column name must match exactly</td>
</tr>
<tr>
<td align="left"><strong>Subsetting with <code>[</code></strong></td>
<td>Can return a vector or data frame depending on syntax</td>
<td>Always returns a tibble (more consistent)</td>
</tr>
<tr>
<td align="left"><strong>Recycling of short vectors</strong></td>
<td>Silent, may lead to subtle bugs</td>
<td>Gives a warning if lengths don’t match</td>
</tr>
<tr>
<td align="left"><strong>Row names</strong></td>
<td>Supports row names</td>
<td>Does not use row names</td>
</tr>
<tr>
<td align="left"><strong>Integration</strong></td>
<td>Basic support for base R functions</td>
<td>Seamless with tidyverse tools</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="tidyverse-functions" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Tidyverse Functions<a href="tidyverse.html#tidyverse-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>dplyr</code>, a main package of the <code>tidyverse</code>, consists of five main functions:</p>
<ol style="list-style-type: decimal">
<li><code>filter()</code>: Subset the data based on specific conditions. <strong>This is for selecting rows.</strong></li>
</ol>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="tidyverse.html#cb136-1" tabindex="-1"></a><span class="co"># create data frame object</span></span>
<span id="cb136-2"><a href="tidyverse.html#cb136-2" tabindex="-1"></a>snbs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">AID =</span> <span class="fu">c</span>(<span class="st">&quot;S488&quot;</span>, <span class="st">&quot;S500&quot;</span>, <span class="st">&quot;S468&quot;</span>),</span>
<span id="cb136-3"><a href="tidyverse.html#cb136-3" tabindex="-1"></a>                   <span class="at">Sex =</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;F&quot;</span>),</span>
<span id="cb136-4"><a href="tidyverse.html#cb136-4" tabindex="-1"></a>                   <span class="at">Herd =</span> <span class="fu">c</span>(<span class="st">&quot;Ca&quot;</span>, <span class="st">&quot;Gb&quot;</span>, <span class="st">&quot;Wh&quot;</span>),</span>
<span id="cb136-5"><a href="tidyverse.html#cb136-5" tabindex="-1"></a>                   <span class="at">RU =</span> <span class="fu">c</span>(<span class="st">&quot;NRU&quot;</span>, <span class="st">&quot;NRU&quot;</span>, <span class="st">&quot;CRU&quot;</span>))</span>
<span id="cb136-6"><a href="tidyverse.html#cb136-6" tabindex="-1"></a><span class="co"># filter to females</span></span>
<span id="cb136-7"><a href="tidyverse.html#cb136-7" tabindex="-1"></a>females <span class="ot">&lt;-</span> <span class="fu">filter</span>(snbs, Sex <span class="sc">==</span> <span class="st">&quot;F&quot;</span>)</span>
<span id="cb136-8"><a href="tidyverse.html#cb136-8" tabindex="-1"></a><span class="fu">head</span>(females, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##    AID Sex Herd  RU
## 1 S500   F   Gb NRU</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><code>select()</code>: Choose specific columns from the data. <strong>This is for selecting columns</strong></li>
</ol>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="tidyverse.html#cb138-1" tabindex="-1"></a><span class="co"># select AID and RU columns</span></span>
<span id="cb138-2"><a href="tidyverse.html#cb138-2" tabindex="-1"></a>snbs_s <span class="ot">&lt;-</span> <span class="fu">select</span>(snbs, AID, RU)</span>
<span id="cb138-3"><a href="tidyverse.html#cb138-3" tabindex="-1"></a></span>
<span id="cb138-4"><a href="tidyverse.html#cb138-4" tabindex="-1"></a><span class="co"># remove one column with negative indexing</span></span>
<span id="cb138-5"><a href="tidyverse.html#cb138-5" tabindex="-1"></a>snbs_s <span class="ot">&lt;-</span> <span class="fu">select</span>(snbs, <span class="sc">-</span>Sex, <span class="sc">-</span>RU)</span>
<span id="cb138-6"><a href="tidyverse.html#cb138-6" tabindex="-1"></a><span class="fu">head</span>(snbs_s, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##    AID Herd
## 1 S488   Ca</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><code>mutate()</code>: Modify or create new variables in the data.</li>
</ol>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="tidyverse.html#cb140-1" tabindex="-1"></a>snbs_s <span class="ot">&lt;-</span> <span class="fu">mutate</span>(snbs, <span class="at">AID_Sex =</span> <span class="fu">paste</span>(AID, Sex, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb140-2"><a href="tidyverse.html#cb140-2" tabindex="-1"></a>  <span class="fu">select</span>(AID, Sex, AID_Sex)</span>
<span id="cb140-3"><a href="tidyverse.html#cb140-3" tabindex="-1"></a><span class="fu">head</span>(snbs_s, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##    AID Sex AID_Sex
## 1 S488   M  S488_M</code></pre>
<ol start="4" style="list-style-type: decimal">
<li><code>group_by()</code>: Group data based on one or more variables for grouped operations.</li>
</ol>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="tidyverse.html#cb142-1" tabindex="-1"></a>snbs_group <span class="ot">&lt;-</span> <span class="fu">group_by</span>(snbs, RU)</span>
<span id="cb142-2"><a href="tidyverse.html#cb142-2" tabindex="-1"></a>snbs_group</span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
## # Groups:   RU [2]
##   AID   Sex   Herd  RU   
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
## 1 S488  M     Ca    NRU  
## 2 S500  F     Gb    NRU  
## 3 S468  F     Wh    CRU</code></pre>
<ol start="5" style="list-style-type: decimal">
<li><code>summarize()</code>: Generate summary statistics from the data. Common summary statistics include: <code>n()</code>, <code>mean()</code>, <code>mode()</code>, <code>range()</code>, <code>median()</code>, <code>sd()</code>.</li>
</ol>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="tidyverse.html#cb144-1" tabindex="-1"></a>snbs_summ <span class="ot">&lt;-</span> <span class="fu">summarize</span>(snbs_group, <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb144-2"><a href="tidyverse.html#cb144-2" tabindex="-1"></a>snbs_summ</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   RU        n
##   &lt;chr&gt; &lt;int&gt;
## 1 CRU       1
## 2 NRU       2</code></pre>
<ol start="6" style="list-style-type: decimal">
<li><code>arrange()</code>: Sort the data in a specific order.</li>
</ol>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="tidyverse.html#cb146-1" tabindex="-1"></a>snbs_sorted <span class="ot">&lt;-</span> <span class="fu">arrange</span>(snbs, Herd)</span>
<span id="cb146-2"><a href="tidyverse.html#cb146-2" tabindex="-1"></a><span class="co"># Sorts character values in alphabetical order by default</span></span>
<span id="cb146-3"><a href="tidyverse.html#cb146-3" tabindex="-1"></a></span>
<span id="cb146-4"><a href="tidyverse.html#cb146-4" tabindex="-1"></a>snbs_sorted_desc <span class="ot">&lt;-</span> <span class="fu">arrange</span>(snbs, <span class="fu">desc</span>(Herd))</span>
<span id="cb146-5"><a href="tidyverse.html#cb146-5" tabindex="-1"></a><span class="co"># Sorts character values in descending alphabetical order</span></span></code></pre></div>
<p>You can perform many operations in one call using the pipe operator:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="tidyverse.html#cb147-1" tabindex="-1"></a>snbs_tidy <span class="ot">&lt;-</span> <span class="fu">filter</span>(snbs, Sex <span class="sc">==</span> <span class="st">&quot;F&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb147-2"><a href="tidyverse.html#cb147-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">AID_Sex =</span> <span class="fu">paste</span>(AID, Sex, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb147-3"><a href="tidyverse.html#cb147-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>RU) <span class="sc">%&gt;%</span></span>
<span id="cb147-4"><a href="tidyverse.html#cb147-4" tabindex="-1"></a>  <span class="fu">group_by</span>(Herd) <span class="sc">%&gt;%</span></span>
<span id="cb147-5"><a href="tidyverse.html#cb147-5" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb147-6"><a href="tidyverse.html#cb147-6" tabindex="-1"></a>  <span class="fu">arrange</span>(Herd)</span></code></pre></div>
<hr />
<p><strong><code>EXERCISE 1</code></strong></p>
<ol style="list-style-type: decimal">
<li>Recreate the following object:</li>
</ol>
<ul>
<li><code>elk_df &lt;- data.frame(</code><br />
<code>elk_id = c("E001", "E002", "E003", "E004", "E005"),</code><br />
<code>weight = c(350, 410, 290, 500, 375),</code><br />
<code>herd = c("North", "South", "East", "West", "North"))</code></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Use <code>filter()</code> to subset weights &gt; 375</li>
<li>Create a new data frame that only contains the elk_id and herd column</li>
<li>Create a new data frame that is grouped by herd. Calculate the number of observations per herd. Arrange the final dataset in alphabetical order.</li>
</ol>
<hr />
</div>
<div id="tidyverse-vs-baser" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Tidyverse vs BaseR<a href="tidyverse.html#tidyverse-vs-baser" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are many different ways to accomplish the same task in R (e.g. using tidyverse or baseR syntax). Whichever syntax you choose depends on what you’re more comfortable with. Personally, I like using a mix of both. Tidyverse code is intuitive, but for really large data sets, baseR works faster. It’s all about finding what works best for you and your data.</p>
<table>
<colgroup>
<col width="22%" />
<col width="30%" />
<col width="47%" />
</colgroup>
<thead>
<tr>
<th><strong>Purpose</strong></th>
<th><strong>Tidyverse (<code>dplyr</code>)</strong></th>
<th><strong>Base R Equivalent</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Subset rows</td>
<td><code>filter()</code></td>
<td><code>subset()</code> or logical indexing: <code>df[df$col == value, ]</code></td>
</tr>
<tr>
<td>Select columns</td>
<td><code>select()</code></td>
<td><code>df[, c("col1", "col2")]</code></td>
</tr>
<tr>
<td>Create/modify columns</td>
<td><code>mutate()</code></td>
<td><code>df$new_col &lt;- ...</code></td>
</tr>
<tr>
<td>Group data</td>
<td><code>group_by()</code></td>
<td><code>tapply()</code>, <code>aggregate()</code>, or <code>split()</code></td>
</tr>
<tr>
<td>Summarize data</td>
<td><code>summarize()</code> (or <code>summarise()</code>)</td>
<td><code>aggregate()</code> or <code>tapply()</code> with <code>mean()</code>, <code>sum()</code>, etc.</td>
</tr>
</tbody>
</table>
</div>
<div id="ggplot" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> ggplot<a href="tidyverse.html#ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div style="text-align: center;">
<img src="docs/files/ggplot.png" alt="ggplot" width="80%">
<p style="font-size: 50%;">
<em>Artwork by Allison Horst</em>
</p>
</div>
<p>ggplot is a powerful and flexible R package used for data visualization. It is part of the tidyverse and is built on the Grammar of Graphics—a layered approach to building plots that allows you to combine data, visual elements, and aesthetics step by step. You can customize nearly every part of a ggplot, including adding titles, axis labels, and legends; adjusting colors, shapes, and sizes; applying different themes; adding trend lines or annotations; and creating multi-panel layouts using faceting.</p>
<p><strong>Key Features</strong></p>
<ol style="list-style-type: decimal">
<li>Layered plotting system: Build plots by adding layers (e.g., points, lines, bars).</li>
<li>Aesthetic mapping: Easily map variables to visual properties like color, size, and shape.</li>
<li>Customizable: Control themes, labels, scales, and more.</li>
<li>Works seamlessly with tidy data and other tidyverse tools.</li>
</ol>
<div id="components-of-ggplot" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Components of ggplot<a href="tidyverse.html#components-of-ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When using ggplot2 in R, your code is built in layers, with each part adding a new component to the plot. Here’s a breakdown of the key components you’ll commonly use:</p>
<ul>
<li>Data: The dataset you’re visualizing.</li>
<li>Aesthetics (aes()): Defines how variables in the data are mapped to visual properties like position, color, or size.</li>
<li>Geometries (geom_<name>()): Determine the type of plot (e.g. points, lines, bars, etc.)</li>
</ul>
<p>Each ggplot() call begins with the data and aesthetic mappings, and layers like geom_<name>() or theme_<name>() are added using the + operator. Let’s go through the main parts step by step.</p>
<p>First we will create a fake lion dataset:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="tidyverse.html#cb148-1" tabindex="-1"></a><span class="co"># Create fake lion data</span></span>
<span id="cb148-2"><a href="tidyverse.html#cb148-2" tabindex="-1"></a>lions <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb148-3"><a href="tidyverse.html#cb148-3" tabindex="-1"></a>  <span class="at">id =</span> <span class="fu">paste0</span>(<span class="st">&quot;Lion&quot;</span>, <span class="dv">200</span><span class="sc">:</span><span class="dv">219</span>),</span>
<span id="cb148-4"><a href="tidyverse.html#cb148-4" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),          <span class="co"># age in years</span></span>
<span id="cb148-5"><a href="tidyverse.html#cb148-5" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">60</span>, <span class="at">sd =</span> <span class="dv">10</span>), <span class="dv">1</span>), <span class="co"># weight in kg</span></span>
<span id="cb148-6"><a href="tidyverse.html#cb148-6" tabindex="-1"></a>  <span class="at">sex =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>), <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb148-7"><a href="tidyverse.html#cb148-7" tabindex="-1"></a>  <span class="at">region =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;Northern&quot;</span>, <span class="st">&quot;Southern&quot;</span>, <span class="st">&quot;Central&quot;</span>, <span class="st">&quot;Olancha&quot;</span>), <span class="dv">20</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb148-8"><a href="tidyverse.html#cb148-8" tabindex="-1"></a>)</span>
<span id="cb148-9"><a href="tidyverse.html#cb148-9" tabindex="-1"></a></span>
<span id="cb148-10"><a href="tidyverse.html#cb148-10" tabindex="-1"></a><span class="fu">head</span>(lions, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##        id age weight sex   region
## 1 Lion200  18   53.8   F Southern
## 2 Lion201  14   51.1   F Northern
## 3 Lion202  11   48.3   M Northern</code></pre>
<ol style="list-style-type: decimal">
<li>The main ggplot() function</li>
</ol>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="tidyverse.html#cb150-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lions, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> weight, <span class="at">color =</span> sex))</span></code></pre></div>
<p><img src="intro-to-r_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<ul>
<li>ggplot(data = lions): This is where we tell ggplot what data we’re using. In this case, it’s the lions data frame.</li>
<li>aes(x = age, y = weight, color = sex): This part is called the aesthetic mapping (or aes for short). It tells ggplot which variables to plot:
<ul>
<li>x = age: We’re plotting age on the x-axis.</li>
<li>y = weight: We’re plotting weight on the y-axis.</li>
<li>color = sex: We want to color the points by the sex variable. This way, male and female lions will have different colors.</li>
</ul></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Adding Points with geom_point()</li>
</ol>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="tidyverse.html#cb151-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lions, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> weight, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb151-2"><a href="tidyverse.html#cb151-2" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="intro-to-r_files/figure-html/unnamed-chunk-56-1.png" width="672" />
* geom_point(): This part tells ggplot to plot the data as points (a scatter plot).
* size = 3: This adjusts the size of the points on the plot to make them more visible.</p>
<ol start="3" style="list-style-type: decimal">
<li>Adding a trendline and labels</li>
</ol>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="tidyverse.html#cb152-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lions, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> weight, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb152-2"><a href="tidyverse.html#cb152-2" tabindex="-1"></a>  <span class="co"># Add scatterplot</span></span>
<span id="cb152-3"><a href="tidyverse.html#cb152-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb152-4"><a href="tidyverse.html#cb152-4" tabindex="-1"></a>  <span class="co"># Adding trend line</span></span>
<span id="cb152-5"><a href="tidyverse.html#cb152-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">color =</span> sex), <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb152-6"><a href="tidyverse.html#cb152-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb152-7"><a href="tidyverse.html#cb152-7" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Mountain Lion Weight by Age&quot;</span>,</span>
<span id="cb152-8"><a href="tidyverse.html#cb152-8" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb152-9"><a href="tidyverse.html#cb152-9" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Weight (kg)&quot;</span>,</span>
<span id="cb152-10"><a href="tidyverse.html#cb152-10" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb152-11"><a href="tidyverse.html#cb152-11" tabindex="-1"></a>  ) </span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="intro-to-r_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<ul>
<li>geom_smooth: creates a trendline for each sex</li>
<li><code>labs()</code>: This function is used to add titles and labels to the plot.
<ul>
<li>title: Adds a title to the plot.</li>
<li>x: Labels the x-axis (Age).</li>
<li>y: Labels the y-axis (Weight).</li>
<li>color: Adds a label for the color legend, which shows the different colors for male and female lions.</li>
</ul></li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li>Final Touches with <code>theme_minimal()</code></li>
</ol>
<ul>
<li>theme_minimal(): This is a simple and clean theme for the plot. It removes unnecessary background grids and makes the plot look more visually appealing. There are many other different themes such as <code>theme_class</code>, <code>theme_dark</code>, and <code>theme_light</code>.</li>
</ul>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="tidyverse.html#cb154-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lions, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> weight, <span class="at">color =</span> sex)) <span class="sc">+</span></span>
<span id="cb154-2"><a href="tidyverse.html#cb154-2" tabindex="-1"></a>  <span class="co"># Add scatterplot</span></span>
<span id="cb154-3"><a href="tidyverse.html#cb154-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb154-4"><a href="tidyverse.html#cb154-4" tabindex="-1"></a>  <span class="co"># Adding trend line</span></span>
<span id="cb154-5"><a href="tidyverse.html#cb154-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">color =</span> sex), <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>) <span class="sc">+</span>  </span>
<span id="cb154-6"><a href="tidyverse.html#cb154-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb154-7"><a href="tidyverse.html#cb154-7" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Mountain Lion Weight by Age&quot;</span>,</span>
<span id="cb154-8"><a href="tidyverse.html#cb154-8" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Age (years)&quot;</span>,</span>
<span id="cb154-9"><a href="tidyverse.html#cb154-9" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Weight (kg)&quot;</span>,</span>
<span id="cb154-10"><a href="tidyverse.html#cb154-10" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Sex&quot;</span></span>
<span id="cb154-11"><a href="tidyverse.html#cb154-11" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb154-12"><a href="tidyverse.html#cb154-12" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="intro-to-r_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>Here is an example of making a barplot that is colored by different region.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="tidyverse.html#cb156-1" tabindex="-1"></a><span class="co"># Create the bar plot, colored by region</span></span>
<span id="cb156-2"><a href="tidyverse.html#cb156-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> lions, <span class="fu">aes</span>(<span class="at">x =</span> region, <span class="at">fill =</span> region)) <span class="sc">+</span> </span>
<span id="cb156-3"><a href="tidyverse.html#cb156-3" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span>  <span class="co"># Bar border color</span></span>
<span id="cb156-4"><a href="tidyverse.html#cb156-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb156-5"><a href="tidyverse.html#cb156-5" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Number of Lions by Region&quot;</span>,</span>
<span id="cb156-6"><a href="tidyverse.html#cb156-6" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Region&quot;</span>,</span>
<span id="cb156-7"><a href="tidyverse.html#cb156-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Count of Lions&quot;</span></span>
<span id="cb156-8"><a href="tidyverse.html#cb156-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb156-9"><a href="tidyverse.html#cb156-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb156-10"><a href="tidyverse.html#cb156-10" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Set3&quot;</span>)  <span class="co"># Using a color palette for better visuals</span></span></code></pre></div>
<p><img src="intro-to-r_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
</div>
<div id="different-plots-in-ggplot" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Different plots in ggplot<a href="tidyverse.html#different-plots-in-ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<colgroup>
<col width="22%" />
<col width="25%" />
<col width="52%" />
</colgroup>
<thead>
<tr>
<th><strong>Plot Type</strong></th>
<th><strong><code>ggplot2</code> Function</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Scatter Plot</td>
<td><code>geom_point()</code></td>
<td>Shows relationship between two continuous variables</td>
</tr>
<tr>
<td>Line Plot</td>
<td><code>geom_line()</code></td>
<td>Displays trends over time or ordered categories</td>
</tr>
<tr>
<td>Bar Chart (counts)</td>
<td><code>geom_bar()</code></td>
<td>Plots the count of categories (x only)</td>
</tr>
<tr>
<td>Bar Chart (values)</td>
<td><code>geom_col()</code></td>
<td>Plots values directly (requires both x and y)</td>
</tr>
<tr>
<td>Boxplot</td>
<td><code>geom_boxplot()</code></td>
<td>Visualizes the distribution and spread by group</td>
</tr>
<tr>
<td>Histogram</td>
<td><code>geom_histogram()</code></td>
<td>Shows distribution of a single continuous variable</td>
</tr>
</tbody>
</table>
<hr />
<p><strong>EXERCISE</strong></p>
<ol style="list-style-type: decimal">
<li>Create the following object:</li>
</ol>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="tidyverse.html#cb157-1" tabindex="-1"></a><span class="co"># Create a fake data frame for bighorn sheep</span></span>
<span id="cb157-2"><a href="tidyverse.html#cb157-2" tabindex="-1"></a>bighorn_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb157-3"><a href="tidyverse.html#cb157-3" tabindex="-1"></a>  <span class="at">ID =</span> <span class="fu">paste0</span>(<span class="st">&quot;S&quot;</span>, <span class="dv">500</span><span class="sc">:</span><span class="dv">530</span>),      <span class="co"># ID for each sheep</span></span>
<span id="cb157-4"><a href="tidyverse.html#cb157-4" tabindex="-1"></a>  <span class="at">Age =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="dv">31</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),  <span class="co"># Random ages between 1 and 10</span></span>
<span id="cb157-5"><a href="tidyverse.html#cb157-5" tabindex="-1"></a>  <span class="at">Weight =</span> <span class="fu">round</span>(<span class="fu">rnorm</span>(<span class="dv">31</span>, <span class="at">mean =</span> <span class="dv">75</span>, <span class="at">sd =</span> <span class="dv">15</span>), <span class="dv">1</span>),  <span class="co"># Random weights with mean of 75 kg and sd of 15</span></span>
<span id="cb157-6"><a href="tidyverse.html#cb157-6" tabindex="-1"></a>  <span class="at">Sex =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>), <span class="dv">31</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),     <span class="co"># Random sexes (Male, Female)</span></span>
<span id="cb157-7"><a href="tidyverse.html#cb157-7" tabindex="-1"></a>  <span class="at">Herd =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;North&quot;</span>, <span class="st">&quot;South&quot;</span>, <span class="st">&quot;East&quot;</span>, <span class="st">&quot;West&quot;</span>), <span class="dv">31</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)  <span class="co"># Random herd names</span></span>
<span id="cb157-8"><a href="tidyverse.html#cb157-8" tabindex="-1"></a>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Create a histogram to visualize the weights of bighorn sheep.</li>
</ol>
<ul>
<li>Set the bins to be blue.</li>
<li>Add a black outline to the bins.</li>
<li>Include a title as well as labels for the x and y axes.</li>
<li>Apply a theme to enhance the plot’s appearance.</li>
</ul>
<hr />
</div>
</div>
<div id="tidyverse-analysis-example" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Tidyverse Analysis Example<a href="tidyverse.html#tidyverse-analysis-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Exercise – Using a data set in R called penguins_raw to perform a simple analysis</p>
<p>Explore the data set:
* Look at the first 5 rows (head)
* Look at the data structure (str)
* How many samples? (nrow)
* Get a list of the column names (names)
* How many species of penguins (unique)</p>
<p>Question we are interested in: <strong>We want to understand how body mass varies by species and sex</strong></p>
<div id="load-libraries" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Load libraries<a href="tidyverse.html#load-libraries" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First let’s load the required libraries.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="tidyverse.html#cb158-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb158-2"><a href="tidyverse.html#cb158-2" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span></code></pre></div>
<pre><code>## Warning: package &#39;palmerpenguins&#39; was built under R version 4.4.1</code></pre>
</div>
<div id="examine-data-frame" class="section level3 hasAnchor" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Examine data frame<a href="tidyverse.html#examine-data-frame" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s look at the first 10 rows of the penguins_raw data frame.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="tidyverse.html#cb160-1" tabindex="-1"></a><span class="fu">head</span>(penguins_raw)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 17
##   studyName `Sample Number` Species          Region Island Stage `Individual ID`
##   &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;            &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;          
## 1 PAL0708                 1 Adelie Penguin … Anvers Torge… Adul… N1A1           
## 2 PAL0708                 2 Adelie Penguin … Anvers Torge… Adul… N1A2           
## 3 PAL0708                 3 Adelie Penguin … Anvers Torge… Adul… N2A1           
## 4 PAL0708                 4 Adelie Penguin … Anvers Torge… Adul… N2A2           
## 5 PAL0708                 5 Adelie Penguin … Anvers Torge… Adul… N3A1           
## 6 PAL0708                 6 Adelie Penguin … Anvers Torge… Adul… N3A2           
## # ℹ 10 more variables: `Clutch Completion` &lt;chr&gt;, `Date Egg` &lt;date&gt;,
## #   `Culmen Length (mm)` &lt;dbl&gt;, `Culmen Depth (mm)` &lt;dbl&gt;,
## #   `Flipper Length (mm)` &lt;dbl&gt;, `Body Mass (g)` &lt;dbl&gt;, Sex &lt;chr&gt;,
## #   `Delta 15 N (o/oo)` &lt;dbl&gt;, `Delta 13 C (o/oo)` &lt;dbl&gt;, Comments &lt;chr&gt;</code></pre>
<p>Let’s examine the structure of the penguins_raw data frame</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="tidyverse.html#cb162-1" tabindex="-1"></a><span class="fu">str</span>(penguins_raw)</span></code></pre></div>
<pre><code>## tibble [344 × 17] (S3: tbl_df/tbl/data.frame)
##  $ studyName          : chr [1:344] &quot;PAL0708&quot; &quot;PAL0708&quot; &quot;PAL0708&quot; &quot;PAL0708&quot; ...
##  $ Sample Number      : num [1:344] 1 2 3 4 5 6 7 8 9 10 ...
##  $ Species            : chr [1:344] &quot;Adelie Penguin (Pygoscelis adeliae)&quot; &quot;Adelie Penguin (Pygoscelis adeliae)&quot; &quot;Adelie Penguin (Pygoscelis adeliae)&quot; &quot;Adelie Penguin (Pygoscelis adeliae)&quot; ...
##  $ Region             : chr [1:344] &quot;Anvers&quot; &quot;Anvers&quot; &quot;Anvers&quot; &quot;Anvers&quot; ...
##  $ Island             : chr [1:344] &quot;Torgersen&quot; &quot;Torgersen&quot; &quot;Torgersen&quot; &quot;Torgersen&quot; ...
##  $ Stage              : chr [1:344] &quot;Adult, 1 Egg Stage&quot; &quot;Adult, 1 Egg Stage&quot; &quot;Adult, 1 Egg Stage&quot; &quot;Adult, 1 Egg Stage&quot; ...
##  $ Individual ID      : chr [1:344] &quot;N1A1&quot; &quot;N1A2&quot; &quot;N2A1&quot; &quot;N2A2&quot; ...
##  $ Clutch Completion  : chr [1:344] &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ...
##  $ Date Egg           : Date[1:344], format: &quot;2007-11-11&quot; &quot;2007-11-11&quot; ...
##  $ Culmen Length (mm) : num [1:344] 39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...
##  $ Culmen Depth (mm)  : num [1:344] 18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...
##  $ Flipper Length (mm): num [1:344] 181 186 195 NA 193 190 181 195 193 190 ...
##  $ Body Mass (g)      : num [1:344] 3750 3800 3250 NA 3450 ...
##  $ Sex                : chr [1:344] &quot;MALE&quot; &quot;FEMALE&quot; &quot;FEMALE&quot; NA ...
##  $ Delta 15 N (o/oo)  : num [1:344] NA 8.95 8.37 NA 8.77 ...
##  $ Delta 13 C (o/oo)  : num [1:344] NA -24.7 -25.3 NA -25.3 ...
##  $ Comments           : chr [1:344] &quot;Not enough blood for isotopes.&quot; NA NA &quot;Adult not sampled.&quot; ...
##  - attr(*, &quot;spec&quot;)=
##   .. cols(
##   ..   studyName = col_character(),
##   ..   `Sample Number` = col_double(),
##   ..   Species = col_character(),
##   ..   Region = col_character(),
##   ..   Island = col_character(),
##   ..   Stage = col_character(),
##   ..   `Individual ID` = col_character(),
##   ..   `Clutch Completion` = col_character(),
##   ..   `Date Egg` = col_date(format = &quot;&quot;),
##   ..   `Culmen Length (mm)` = col_double(),
##   ..   `Culmen Depth (mm)` = col_double(),
##   ..   `Flipper Length (mm)` = col_double(),
##   ..   `Body Mass (g)` = col_double(),
##   ..   Sex = col_character(),
##   ..   `Delta 15 N (o/oo)` = col_double(),
##   ..   `Delta 13 C (o/oo)` = col_double(),
##   ..   Comments = col_character()
##   .. )</code></pre>
<p>Let’s look at how many rows are in the penguins_raw data frame</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="tidyverse.html#cb164-1" tabindex="-1"></a><span class="fu">nrow</span>(penguins_raw)</span></code></pre></div>
<pre><code>## [1] 344</code></pre>
<p>Let’s look at the unique species in the <code>Species</code> column of the penguins_raw data frame using the <code>unique()</code> function.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="tidyverse.html#cb166-1" tabindex="-1"></a><span class="fu">unique</span>(penguins_raw<span class="sc">$</span>Species)</span></code></pre></div>
<pre><code>## [1] &quot;Adelie Penguin (Pygoscelis adeliae)&quot;      
## [2] &quot;Gentoo penguin (Pygoscelis papua)&quot;        
## [3] &quot;Chinstrap penguin (Pygoscelis antarctica)&quot;</code></pre>
<p>Now let’s take a look at the column names in the penguins_raw dataset.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="tidyverse.html#cb168-1" tabindex="-1"></a><span class="fu">dput</span>(<span class="fu">names</span>(penguins_raw))</span></code></pre></div>
<pre><code>## c(&quot;studyName&quot;, &quot;Sample Number&quot;, &quot;Species&quot;, &quot;Region&quot;, &quot;Island&quot;, 
## &quot;Stage&quot;, &quot;Individual ID&quot;, &quot;Clutch Completion&quot;, &quot;Date Egg&quot;, &quot;Culmen Length (mm)&quot;, 
## &quot;Culmen Depth (mm)&quot;, &quot;Flipper Length (mm)&quot;, &quot;Body Mass (g)&quot;, 
## &quot;Sex&quot;, &quot;Delta 15 N (o/oo)&quot;, &quot;Delta 13 C (o/oo)&quot;, &quot;Comments&quot;)</code></pre>
<p>In the previous code <code>dput(names(penguins_raw))</code>, R follows its usual order of operations by evaluating the innermost function first. So:</p>
<ol style="list-style-type: decimal">
<li><code>names(penguins_raw)</code> retrieves the column names of the dataset as a character vector.</li>
<li><code>dput()</code> then takes that result and prints it in a format that can be copied and reused as R code.</li>
</ol>
<p>The dput() function (short for “dump put”) converts an object into valid R code.</p>
</div>
<div id="manipulate-data-frame" class="section level3 hasAnchor" number="6.6.3">
<h3><span class="header-section-number">6.6.3</span> Manipulate data frame<a href="tidyverse.html#manipulate-data-frame" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Subsample the penguins_raw to create a new data set called p_measure.</p>
<p>First we will reassign the penguins_raw dataset to a new object called p_measure</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="tidyverse.html#cb170-1" tabindex="-1"></a>p_measure<span class="ot">&lt;-</span>penguins_raw</span></code></pre></div>
<p>Let’s select the 3rd, 5th, and 9th through 14th columns. Below are examples using both Base R and tidyverse approaches.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="tidyverse.html#cb171-1" tabindex="-1"></a><span class="co"># base R method</span></span>
<span id="cb171-2"><a href="tidyverse.html#cb171-2" tabindex="-1"></a>p_measure<span class="ot">&lt;-</span>p_measure[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">9</span><span class="sc">:</span><span class="dv">14</span>)]</span>
<span id="cb171-3"><a href="tidyverse.html#cb171-3" tabindex="-1"></a></span>
<span id="cb171-4"><a href="tidyverse.html#cb171-4" tabindex="-1"></a><span class="co"># tidyverse method</span></span>
<span id="cb171-5"><a href="tidyverse.html#cb171-5" tabindex="-1"></a><span class="co"># p_measure&lt;-select(p_measure, Species, Island, &quot;Date Egg&quot;, &quot;Culmen Length (mm)&quot;,</span></span>
<span id="cb171-6"><a href="tidyverse.html#cb171-6" tabindex="-1"></a><span class="co">#                   &quot;Culmen Depth (mm)&quot;, &quot;Flipper Length (mm)&quot;, &quot;Body Mass (g)&quot;, Sex)</span></span></code></pre></div>
<ul>
<li>We remove the following columns (studyName, Sample Number, Region, Stage, Clutch Completion, Delta 15 N (o/oo), Delta 13 C (o/oo) and Comments</li>
<li>We keep the following columns (Species, Island, Date Egg Culmen Length (mm), Culmen Depth (mm), Flipper Length(mm), Body Mass (g), Sex)</li>
</ul>
<p>Now let’s rename the column names to eliminate spaces. Below are examples using the baseR and tidyverse methods.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="tidyverse.html#cb172-1" tabindex="-1"></a><span class="co"># baseR method</span></span>
<span id="cb172-2"><a href="tidyverse.html#cb172-2" tabindex="-1"></a><span class="fu">names</span>(p_measure)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;species&quot;</span>,<span class="st">&quot;island&quot;</span>, <span class="st">&quot;date&quot;</span>, <span class="st">&quot;bill_len&quot;</span>, <span class="st">&quot;bill_dep&quot;</span>, <span class="st">&quot;flipper_len&quot;</span>, </span>
<span id="cb172-3"><a href="tidyverse.html#cb172-3" tabindex="-1"></a>                    <span class="st">&quot;body_mass&quot;</span>, <span class="st">&quot;sex&quot;</span>)</span>
<span id="cb172-4"><a href="tidyverse.html#cb172-4" tabindex="-1"></a><span class="co"># tidyverse method</span></span>
<span id="cb172-5"><a href="tidyverse.html#cb172-5" tabindex="-1"></a><span class="co"># p_measure&lt;-rename(p_measure, species = Species, island = Island, date = &quot;Date Egg&quot;,</span></span>
<span id="cb172-6"><a href="tidyverse.html#cb172-6" tabindex="-1"></a><span class="co">#                   bill_len = &quot;Culmen Length (mm)&quot;, bill_dep = &quot;Culmen Depth (mm)&quot;,</span></span>
<span id="cb172-7"><a href="tidyverse.html#cb172-7" tabindex="-1"></a><span class="co">#                   flipper_len = &quot;Flipper Length (mm)&quot;, body_mass = &quot;Body Mass (g)&quot;, </span></span>
<span id="cb172-8"><a href="tidyverse.html#cb172-8" tabindex="-1"></a><span class="co">#                   sex = Sex)</span></span></code></pre></div>
<p>Now we’ll use the pipe operator (<code>%&gt;%</code>) to add a column called <code>year</code> using mutate <code>(year=year(date))</code>. The<code>mutate()</code> function is used to add or modify columns in a data frame, and the <code>year()</code> function extracts the year component from a date. We then remove the date column using <code>select()</code>.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="tidyverse.html#cb173-1" tabindex="-1"></a>p_measure<span class="ot">&lt;-</span>p_measure<span class="sc">%&gt;%</span></span>
<span id="cb173-2"><a href="tidyverse.html#cb173-2" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">year=</span><span class="fu">year</span>(date))<span class="sc">%&gt;%</span></span>
<span id="cb173-3"><a href="tidyverse.html#cb173-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">3</span>)<span class="sc">%&gt;%</span></span>
<span id="cb173-4"><a href="tidyverse.html#cb173-4" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(body_mass)<span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(sex))</span></code></pre></div>
<p>Let’s look at our new data frame using <code>head()</code></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="tidyverse.html#cb174-1" tabindex="-1"></a><span class="fu">head</span>(p_measure)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 8
##   species             island bill_len bill_dep flipper_len body_mass sex    year
##   &lt;chr&gt;               &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
## 1 Adelie Penguin (Py… Torge…     39.1     18.7         181      3750 MALE   2007
## 2 Adelie Penguin (Py… Torge…     39.5     17.4         186      3800 FEMA…  2007
## 3 Adelie Penguin (Py… Torge…     40.3     18           195      3250 FEMA…  2007
## 4 Adelie Penguin (Py… Torge…     36.7     19.3         193      3450 FEMA…  2007
## 5 Adelie Penguin (Py… Torge…     39.3     20.6         190      3650 MALE   2007
## 6 Adelie Penguin (Py… Torge…     38.9     17.8         181      3625 FEMA…  2007</code></pre>
</div>
<div id="analysis" class="section level3 hasAnchor" number="6.6.4">
<h3><span class="header-section-number">6.6.4</span> Analysis<a href="tidyverse.html#analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s create our final analysis data frame object called <code>output_analysis</code>. We will use the data set called penguins (it’s a cleaner version of the data set we just created from penguins_raw). The steps to perform include:</p>
<ol style="list-style-type: decimal">
<li>Remove rows with <code>NA</code> values in the <code>body_mass</code> and <code>sex</code> columns.</li>
<li>Group the data by species and sex.</li>
<li>Summarize each group by calculating:</li>
</ol>
<ul>
<li>Number of samples (n)</li>
<li>Mean body mass (mean_bm)</li>
<li>Median body mass (median_bm)</li>
<li>Standard deviation of body mass (SD_bm)</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>Add confidence intervals</li>
</ol>
<ul>
<li>LCL: Lower confidence limit (mean - 2 × SD)</li>
<li>UCL: Upper confidence limit (mean + 2 × SD)</li>
</ul>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="tidyverse.html#cb176-1" tabindex="-1"></a>output_analysis<span class="ot">&lt;-</span>penguins<span class="sc">%&gt;%</span></span>
<span id="cb176-2"><a href="tidyverse.html#cb176-2" tabindex="-1"></a>  <span class="co"># Filter out rows where body_mass is NA (filter using !is.na)</span></span>
<span id="cb176-3"><a href="tidyverse.html#cb176-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(body_mass_g)<span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(sex))<span class="sc">%&gt;%</span></span>
<span id="cb176-4"><a href="tidyverse.html#cb176-4" tabindex="-1"></a>  <span class="co"># Group data by species and sex (group_by)</span></span>
<span id="cb176-5"><a href="tidyverse.html#cb176-5" tabindex="-1"></a>  <span class="fu">group_by</span>(species,sex)<span class="sc">%&gt;%</span></span>
<span id="cb176-6"><a href="tidyverse.html#cb176-6" tabindex="-1"></a>  <span class="co"># Summarize data (n, mean, median, sd)</span></span>
<span id="cb176-7"><a href="tidyverse.html#cb176-7" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>(), <span class="co"># number of samples (n)</span></span>
<span id="cb176-8"><a href="tidyverse.html#cb176-8" tabindex="-1"></a>            <span class="at">mean_bm=</span><span class="fu">mean</span>(body_mass_g), <span class="co"># calculate mean body mass</span></span>
<span id="cb176-9"><a href="tidyverse.html#cb176-9" tabindex="-1"></a>            <span class="at">median_bm=</span><span class="fu">median</span>(body_mass_g), <span class="co"># calculate median body mass</span></span>
<span id="cb176-10"><a href="tidyverse.html#cb176-10" tabindex="-1"></a>            <span class="at">SD_bm=</span><span class="fu">sd</span>(body_mass_g))<span class="sc">%&gt;%</span> <span class="co"># caluclate the standard deviation of body mass</span></span>
<span id="cb176-11"><a href="tidyverse.html#cb176-11" tabindex="-1"></a>  <span class="co"># Add confidence intervals using mutate</span></span>
<span id="cb176-12"><a href="tidyverse.html#cb176-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">LCL=</span>mean_bm<span class="dv">-2</span><span class="sc">*</span>SD_bm, <span class="co"># calculate the lower confidence interval level</span></span>
<span id="cb176-13"><a href="tidyverse.html#cb176-13" tabindex="-1"></a>         <span class="at">UCL=</span>mean_bm<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>SD_bm) <span class="co"># calculate the upper confidence interval level</span></span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;species&#39;. You can
## override using the `.groups` argument.</code></pre>
</div>
<div id="plot-results-using-ggplot2" class="section level3 hasAnchor" number="6.6.5">
<h3><span class="header-section-number">6.6.5</span> Plot results using ggplot2<a href="tidyverse.html#plot-results-using-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, we will generate a ggplot from our analysis using the data frame above.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="tidyverse.html#cb178-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> output_analysis, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">paste0</span>(sex,species), <span class="at">y =</span> mean_bm, <span class="at">ymin=</span>LCL, <span class="at">ymax=</span>UCL, <span class="at">color =</span> species)) <span class="sc">+</span></span>
<span id="cb178-2"><a href="tidyverse.html#cb178-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span>  <span class="co"># Add points</span></span>
<span id="cb178-3"><a href="tidyverse.html#cb178-3" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">width =</span> <span class="fl">0.4</span>) <span class="sc">+</span> <span class="co">#  add error bars</span></span>
<span id="cb178-4"><a href="tidyverse.html#cb178-4" tabindex="-1"></a>  <span class="co"># angle text on x axis for readability</span></span>
<span id="cb178-5"><a href="tidyverse.html#cb178-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>)) <span class="sc">+</span>  </span>
<span id="cb178-6"><a href="tidyverse.html#cb178-6" tabindex="-1"></a>  <span class="co"># Hide x an y axis tick mark labels</span></span>
<span id="cb178-7"><a href="tidyverse.html#cb178-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb178-8"><a href="tidyverse.html#cb178-8" tabindex="-1"></a>  <span class="co"># add annotations to graph</span></span>
<span id="cb178-9"><a href="tidyverse.html#cb178-9" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">2.25</span> , <span class="at">y =</span> <span class="dv">5600</span>, <span class="at">label =</span> <span class="st">&quot;Female&quot;</span>)<span class="sc">+</span>  </span>
<span id="cb178-10"><a href="tidyverse.html#cb178-10" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">xend =</span> <span class="fl">3.4</span>, <span class="at">y =</span> <span class="dv">5500</span>,  <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb178-11"><a href="tidyverse.html#cb178-11" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">5.25</span> , <span class="at">y =</span> <span class="dv">3100</span>, <span class="at">label =</span> <span class="st">&quot;Male&quot;</span>)<span class="sc">+</span>  </span>
<span id="cb178-12"><a href="tidyverse.html#cb178-12" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> <span class="fl">3.6</span>, <span class="at">xend =</span> <span class="fl">6.4</span>, <span class="at">y =</span> <span class="dv">3000</span>,  <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>)  <span class="sc">+</span></span>
<span id="cb178-13"><a href="tidyverse.html#cb178-13" tabindex="-1"></a>  <span class="co"># label axes and graph</span></span>
<span id="cb178-14"><a href="tidyverse.html#cb178-14" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb178-15"><a href="tidyverse.html#cb178-15" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Penguin Weight by Species &amp; Sex&quot;</span>,</span>
<span id="cb178-16"><a href="tidyverse.html#cb178-16" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb178-17"><a href="tidyverse.html#cb178-17" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Mass (g)&quot;</span>,</span>
<span id="cb178-18"><a href="tidyverse.html#cb178-18" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Species&quot;</span></span>
<span id="cb178-19"><a href="tidyverse.html#cb178-19" tabindex="-1"></a>  ) </span></code></pre></div>
<p><img src="intro-to-r_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="using-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="import-export.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-Tidyverse.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["intro-to-r.pdf", "intro-to-r.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
